\chapter{Конструкторский раздел}
\label{ch:design}

\section{Выбор языка программирования}
\label{sec:language}
Для разработки приложений под Android используют, в основном, три языка программирования: Kotlin, Java и C++.

Kotlin стоит на первом месте не с проста.
В 2017 году компания Google объявила Kotlin новым официальным языком для Android и на то есть причины.
Java очень медленно развивалась, новые версии выходили с периодичностью раз в два-три года и новый функционал добавлялся крайне осторожно.
Например, в Java нет атрибутов класса, которые есть во многих современных языках, и приходится писать слишком много однотипного кода (геттеров и сеттеров) для тривиальной задачи "--- хранение внутреннего состояния объекта.

Еще одной большой проблемой Java является отсутствие null-безопасности.
То есть никогда нельзя быть уверенным, что в определенном месте кода объект не является null и есть вероятность получить NullPointerException в самом неожиданном месте.

Даже сейчас, когда Oracle внесла изменения в цикл релизов Java и выпускает их каждые полгода, это не спасёт Java для Android.
Причина тому "--- обратная совместимость приложений со старыми версиями Android API\@.
Например, поддержка Java 7 была добавлена в Android 4.4 (API 19, 2013 год), и эта версия считается стандартной целевой версией для широкой аудитории, так как на этой версии всё еще работает около 10\% устройств.
На более старых версиях суммарно работает меньше пяти процентов, поэтому именно эта версия позволяет достигнуть покрытия аудитории 95\%.
Поддержка Java 8 была добавлена только в Android N (API 24, 2016 год), но эта версия еще не скоро станет целевой, и трудно представить когда, при таких темпах обновления целевой версии, разработчики смогут использовать функции недавно вышедшей Java 10 или Java 11, которая выйдет через полгода.

Разработчикам на Android требовался современный, обновляющийся и простой язык, но при этом, чтобы можно было использовать существующие библиотеки, написанные на Java.
Сейчас существует много JVM языков, которые в той или иной мере совместимы с Java, но ни один из них, кроме Kotlin, не обрёл широкой популярности.
Scala "--- слишком сложна в освоении.
Groovy "--- допускает слишком много вольностей (даже самую простую задачу, например, объявление метода, можно решить несколькими способами), а динамическое выведение типов приводит к ошибкам во время выполнения.
Kotlin же постарался вобрать в себя все положительные стороны каждого из языков, но и добавить своего и полностью исключить неоднозначности.
Тут есть удобные функциональные и nullable типы, как в Groovy, data-классы как в Scala, extension-функции и перегрузка операторов, как в C\# и т.д.

Например, чтобы объявить простой класс с несколькими внутренними состояниями и параметрами конструктора по умолчанию в Java потребуется такой код:\\

\begingroup
\javafile{inc/src/Student.java}
\captionof{listing}{Пример data-класса на Java\label{lst:studentJava}}
\endgroup

В Kotlin же для того чтобы выполнить ту же самую задачу потребуется гораздо меньше кода:

\begin{listing}[H]
  \kotlinfile{inc/src/Student.kt}
  \caption{Пример data-класса на Kotlin}
  \label{lst:studentKt}
\end{listing}

Вот пример null-безопасного кода на Kotlin:

\begin{listing}[H]
  \kotlinfile{inc/src/null.kt}
  \caption{Пример null-безопасности на Kotlin}
  \label{lst:nullKt}
\end{listing}

Kotlin очень быстро развивается и, в отличие от Java, для того чтобы использовать новую версию, достаточно лишь её подключить.
Kotlin полностью совместим с Java, а значит с ним можно использовать все библиотеки, написанные на Java, коих для Android очень много.

Среди языков разработки был упомянут еще C++.
Его используют только в специфических случаях, когда надо написать высокопроизводительный код.
Обычно это работа с графикой, звуком и т.д.
Минусом является то, что на С++ нельзя напрямую работать с Android SDK и нельзя использовать библиотеки, написанные на Java.

\begin{table}
  \caption{Сравнение языков программирования для Android}
  \label{tab:langs}
  \begin{tabular}{|P{0.4\textwidth}|c|c|c|}
    \hline
    Критерий & Kotlin~\cite{kotlin:features} & Java~\cite{java:main}& C++~\cite{cpp:main}\\
    \hline
    Прямая работа с Android SDK                       & $+$    & $+$  & $-$ \\
    \hline
    Наличие большого количества библиотек под Android & $+$    & $+$  & $-$ \\
    \hline
    Возможность управления памятью напрямую           & $-$    & $-$  & $+$ \\
    \hline
    Простой синтаксис                                 & $+$    & $-$  & $-$ \\
    \hline
    Data-классы, null-безопасность                    & $+$    & $-$  & $-$ \\
    \hline
  \end{tabular}
\end{table}

По итогам сравнения этих трёх языков программирования была составлена таблица~\ref{tab:langs}.
Был выбран язык Kotlin, как видно из таблицы, он имеет преимущество над остальными языками.


\section{Выбор среды разработки}
\label{sec:ide}


\section{Выбор стека технологий}
\label{sec:stack}

\section{Архитектура и алгоритм работы МП СУПС}
\label{sec:architecture}

\section{Разработка пользовательского интерфейса}
\label{sec:gui}

\conclusions
\label{sec:designConclusions}
